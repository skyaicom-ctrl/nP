<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nPerspective 2026 ì‹ ë…„íšŒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-bg: #0a0a0f;
            --color-gold: #d4af37;
            --color-purple: #7c3aed;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--color-bg);
            color: #ffffff;
            overflow-x: hidden;
            user-select: none;
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e1e24; }
        ::-webkit-scrollbar-thumb { background: var(--color-gold); border-radius: 4px; }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .text-shimmer {
            background: linear-gradient(to right, #a855f7 0%, var(--color-gold) 50%, #a855f7 100%);
            background-size: 200% auto;
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
            animation: shimmer 4s linear infinite;
        }

        .fade-in { animation: fadeIn 0.5s ease-out forwards; opacity: 0; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .urgent-pulse { animation: urgentPulse 0.5s infinite; color: #ef4444 !important; text-shadow: 0 0 10px #ef4444; }
        @keyframes urgentPulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.8; transform: scale(1.05); } }

        .btn-gold {
            background: linear-gradient(135deg, var(--color-gold), #b48a10);
            color: #000;
            font-weight: 800;
            transition: all 0.2s ease;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.4);
        }
        .btn-gold:active { transform: scale(0.95); }
        .btn-gold:disabled { background: #333; color: #666; box-shadow: none; cursor: not-allowed; transform: none; }

        .card-glass {
            background: rgba(30, 30, 40, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center relative">

    <!-- Header -->
    <header id="nav-header" class="fixed top-0 w-full p-4 flex justify-between items-center z-50 bg-black/50 backdrop-blur-md border-b border-white/10 hidden">
        <div class="text-[#d4af37] font-bold text-xl cursor-pointer" onclick="App.router('menu')">nPerspective 2026</div>
        <div class="flex gap-4">
            <button onclick="App.resetData()" class="text-xs text-gray-500 hover:text-red-500">Reset System</button>
            <button onclick="App.router('schedule')" class="text-sm hover:text-purple-400">ì‹ìˆœ</button>
            <button onclick="App.router('menu')" class="text-sm hover:text-purple-400">ê²Œì„í™ˆ</button>
        </div>
    </header>

    <!-- Main Content -->
    <main id="app-root" class="w-full max-w-7xl px-4 py-20 flex flex-col items-center justify-center flex-grow">
        <!-- Dynamic Content -->
    </main>

<script>
/* -------------------------------------------------------------------------- */
/* DATA MODEL                                 */
/* -------------------------------------------------------------------------- */
const GAME_DATA = {
    schedule: [
        { time: "05:00-05:30", title: "ë¦¬ì…‰ì…˜", desc: "ì°¸ì„ì ë“±ë¡ ë° í™˜ì˜" },
        { time: "05:30-06:00", title: "AI ì¹œêµ¬ ì‚¼ê¸°", desc: "ê¹€í˜„ê²¸ íšŒì¥" },
        { time: "06:00-06:30", title: "ë‚´ ì§€ê°‘ì— ë‹´ì„ ê±´ ë­ëƒ?", desc: "ì´ì¤€ì„­ ëŒ€í‘œ" },
        { time: "06:30-07:30", title: "ì €ë… ì‹ì‚¬", desc: "ë‚˜ëˆ„ê³  ì‹¶ì€ ì´ì•¼ê¸°" },
        { time: "07:30-07:45", title: "ë‚˜ëˆ„ê³  ì‹¶ì€ ì´ì•¼ê¸°", desc: "ì´ì²œìš© ëŒ€í‘œ" },
        { time: "07:45-10:00", title: "nP í•™ìš°ë“¤ ì„œë¡œ ì•Œì•„ê°€ê¸°", desc: "ë ˆí¬ë¦¬ì—ì´ì…˜ (Click to Start)", action: "menu" },
        { time: "10:00-", title: "ë” ê¹Šì´ ì•Œì•„ê°€ê¸°", desc: "ë„¤íŠ¸ì›Œí‚¹" }
    ],
    // Game 0: 40 Questions
    game0_questions: [
        "ë°”ì  ë•Œë„ ì´ê±´ ê¼­ ì§€í‚¤ë ¤ê³  í•˜ëŠ” ë‚˜ë§Œì˜ ë£¨í‹´ì´ ìˆë‚˜ìš”?", "í•˜ë£¨ ì¤‘ ìœ ë‚œíˆ ì¢‹ì•„í•˜ëŠ” ì‹œê°„ëŒ€ê°€ ìˆë‚˜ìš”?", 
        "ì—¬í–‰ì„ ê°„ë‹¤ë©´, ë‚˜ì—ê²Œ ê°€ì¥ ì¤‘ìš”í•œ ìš°ì„ ìˆœìœ„ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ê°‘ìê¸° 1ì£¼ì¼ì˜ íœ´ê°€ê°€ ìƒê¸´ë‹¤ë©´, ì–´ë””ì—ì„œ ëˆ„êµ¬ì™€ ë¬´ì—‡ì„ í•˜ê³  ì‹¶ìœ¼ì„¸ìš”?",
        "ìŠ¤íŠ¸ë ˆìŠ¤ê°€ ìŒ“ì¼ ë•Œ, ë‚˜ë§Œì˜ í•´ì†Œ ë°©ë²•ì´ ìˆë‚˜ìš”?", "ë‹¤ì‹œ ì²˜ìŒë¶€í„° ë°°ì›Œë³´ê³  ì‹¶ì€ ì·¨ë¯¸ë‚˜ í™œë™ì´ ìˆë‚˜ìš”?",
        "íœ´ëŒ€í° ì‚¬ì§„ì²©ì— ì œì¼ ë§ì€ ì‚¬ì§„ì€ ë³´í†µ ë­ì˜ˆìš”?", "ìš”ì¦˜ ë“¤ì–´ ì¡°ê¸ˆ ë°”ë€Œì—ˆë‹¤ê³  ëŠë¼ëŠ” ë‚˜ì˜ ëª¨ìŠµì´ ìˆë‚˜ìš”?",
        "ìš”ì¦˜ ë‚˜ì—ê²Œ ì†Œì†Œí•œ ì¦ê±°ì›€ í•˜ë‚˜ë¥¼ ê¼½ëŠ”ë‹¤ë©´ ë­ê°€ ìˆì„ê¹Œìš”?", "ì˜¬í•´ëŠ” ë‚˜ ìì‹ ì—ê²Œ ì´ëŸ° ì‹œê°„ì„ ë” ì£¼ê³  ì‹¶ë‹¤ëŠ” ê²Œ ìˆë‹¤ë©´ìš”?",
        "ê°€ì¥ ê¸°ì–µì— ë‚¨ëŠ” ì¸ìƒ ì˜í™”ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "í•™ì°½ì‹œì ˆ ê°€ì¥ ê¸°ì–µì— ë‚¨ëŠ” ì—í”¼ì†Œë“œëŠ”?",
        "ë‚´ê°€ ê°€ì§„ ë¬¼ê±´ ì¤‘ ê°€ì¥ ì˜¤ë˜ëœ ì• ì¥í’ˆì€?", "ë‚˜ë¥¼ í•œ ë‹¨ì–´ë¡œ í‘œí˜„í•œë‹¤ë©´?",
        "ì•„ì¹¨í˜• ì¸ê°„ì¸ê°€ìš”, ì˜¬ë¹¼ë¯¸í˜• ì¸ê°„ì¸ê°€ìš”?", "íƒ•ìˆ˜ìœ¡ì€ ë¶€ë¨¹ vs ì°ë¨¹?",
        "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ê³„ì ˆê³¼ ê·¸ ì´ìœ ëŠ”?", "ì£½ê¸° ì „ì— ê¼­ ê°€ë³´ê³  ì‹¶ì€ ì—¬í–‰ì§€ëŠ”?",
        "ë‚˜ë§Œì˜ ì†Œìš¸ í‘¸ë“œëŠ” ë¬´ì—‡ì¸ê°€ìš”?", "ìµœê·¼ì— ê°€ì¥ í¬ê²Œ ì›ƒì—ˆë˜ ì¼ì€?",
        "ë¡œë˜ 1ë“±ì— ë‹¹ì²¨ëœë‹¤ë©´ ê°€ì¥ ë¨¼ì € í•  ì¼ì€?", "ì–´ë¦´ ì  ì¥ë˜í¬ë§ì€ ë¬´ì—‡ì´ì—ˆë‚˜ìš”?",
        "ê°€ì¥ ì¡´ê²½í•˜ëŠ” ì¸ë¬¼ì€ ëˆ„êµ¬ì¸ê°€ìš”?", "ì£¼ë§ì—ëŠ” ì£¼ë¡œ ë¬´ì—‡ì„ í•˜ë©° ì‹œê°„ì„ ë³´ë‚´ë‚˜ìš”?",
        "ë…¸ë˜ë°© ì• ì°½ê³¡ 18ë²ˆì€?", "íŒ€ì›ë“¤ì—ê²Œ ë“£ê³  ì‹¶ì€ ì¹­ì°¬ í•œë§ˆë””ëŠ”?",
        "ì˜¬í•´ ê¼­ ì´ë£¨ê³  ì‹¶ì€ ëª©í‘œ í•œ ê°€ì§€ëŠ”?", "ê°€ì¥ ë‘ë ¤ì›Œí•˜ëŠ” ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?",
        "ì§€ê¸ˆ ì§€ê°‘ì— í˜„ê¸ˆì€ ì–¼ë§ˆê°€ ìˆë‚˜ìš”?", "ì¢‹ì•„í•˜ëŠ” ìŠ¤í¬ì¸ ê°€ ìˆë‚˜ìš”?",
        "ë‹¤ì‹œ íƒœì–´ë‚œë‹¤ë©´ ì–´ë–¤ ì§ì—…ì„ ê°–ê³  ì‹¶ë‚˜ìš”?", "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ìƒ‰ê¹”ì€?",
        "ë‚˜ì—ê²Œ 100ì–µì´ ìƒê¸´ë‹¤ë©´?", "ì€í‡´ í›„ ì‚´ê³  ì‹¶ì€ ë„ì‹œëŠ”?",
        "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ê³„ì ˆ ìŒì‹ì€?", "ì˜¤ëŠ˜ íšŒì‹ ë©”ë‰´ ì¶”ì²œ í•˜ë‚˜ë§Œ í•´ì£¼ì„¸ìš”!",
        "ìµœê·¼ì— ì½ì€ ì±… ì¤‘ ì¶”ì²œí•˜ê³  ì‹¶ì€ ê²ƒì€?", "ë‚˜ë§Œì˜ ê±´ê°• ê´€ë¦¬ ë¹„ë²•ì´ ìˆë‹¤ë©´?",
        "ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ë””ì €íŠ¸ëŠ”?", "ì˜¤ëŠ˜ ì´ ìë¦¬ì— ì˜¨ ì†Œê° í•œë§ˆë””!"
    ],
    // Game 1: Quiz (8 Sets x 10)
    game1_sets: [
        [ // Set 1
            {q:"ê°“ìƒ", a:"ì‹ (God)+ì¸ìƒ. ë¶€ì§€ëŸ°í•œ ì‚¶"}, {q:"ì•Œì˜ë”±ê¹”ì„¼", a:"ì•Œì•„ì„œ ì˜ ë”± ê¹”ë”í•˜ê³  ì„¼ìŠ¤ìˆê²Œ"},
            {q:"ìŠ¤ë¶ˆì¬", a:"ìŠ¤ìŠ¤ë¡œ ë¶ˆëŸ¬ì˜¨ ì¬ì•™"}, {q:"ì¤‘êº¾ë§ˆ", a:"ì¤‘ìš”í•œ ê±´ êº¾ì´ì§€ ì•ŠëŠ” ë§ˆìŒ"},
            {q:"ë§Œë°˜ì˜ë¶€", a:"ë§Œë‚˜ì„œ ë°˜ê°€ì›Œ ì˜ ë¶€íƒí•´"}, {q:"ê¾¸ì•ˆê¾¸", a:"ê¾¸ë¯¼ ë“¯ ì•ˆ ê¾¸ë¯¼ ë“¯"},
            {q:"ì–µí…", a:"ì–µì§€ í…ì…˜"}, {q:"ì™„ë‚´ìŠ¤", a:"ì™„ì „ ë‚´ ìŠ¤íƒ€ì¼"},
            {q:"êµ°ì‹¹", a:"êµ°ì¹¨ì´ ì‹¹ ë„ë„¤"}, {q:"ë¨¸ì„ 129", a:"ë¬´ìŠ¨ ì¼ì´ê³ ?"}
        ],
        [ // Set 2
            {q:"ë¶„ì¢‹ì¹´", a:"ë¶„ìœ„ê¸° ì¢‹ì€ ì¹´í˜"}, {q:"ìº˜ë°•", a:"ìº˜ë¦°ë” ë°•ì œ (ì¼ì • ì €ì¥)"},
            {q:"ë³µì„¸í¸ì‚´", a:"ë³µì¡í•œ ì„¸ìƒ í¸í•˜ê²Œ ì‚´ì"}, {q:"ë³„ë‹¤ì¤„", a:"ë³„ê±¸ ë‹¤ ì¤„ì¸ë‹¤"},
            {q:"ë¹„ë‹´", a:"ë¹„ì£¼ì–¼ ë‹´ë‹¹"}, {q:"ì‚¼ê·€ë‹¤", a:"ì‚¬ê·€ê¸° ì „ ë‹¨ê³„ (ì¸)"},
            {q:"ì–´ì©”í‹°ë¹„", a:"ì–´ì©Œë¼ê³  TVë‚˜ ë´"}, {q:"ì €ë©”ì¶”", a:"ì €ë… ë©”ë‰´ ì¶”ì²œ"},
            {q:"í‚¹ë°›ë„¤", a:"ì—´ë°›ë„¤ (í‚¹+ì—´ë°›ë„¤)"}, {q:"ë§ˆìƒ", a:"ë§ˆìŒì˜ ìƒì²˜"}
        ],
        [ // Set 3
            {q:"ê°‘ë¶„ì‹¸", a:"ê°‘ìê¸° ë¶„ìœ„ê¸° ì‹¸í•´ì§"}, {q:"ì´ìƒë§", a:"ì´ë²ˆ ìƒì€ ë§í–ˆë‹¤"},
            {q:"ì†Œí™•í–‰", a:"ì†Œì†Œí•˜ì§€ë§Œ í™•ì‹¤í•œ í–‰ë³µ"}, {q:"ì–¼ì£½ì•„", a:"ì–¼ì–´ ì£½ì–´ë„ ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸"},
            {q:"ì—„ê·¼ì§„", a:"ì—„ê²© ê·¼ì—„ ì§„ì§€"}, {q:"ìë§Œì¶”", a:"ìì—°ìŠ¤ëŸ¬ìš´ ë§Œë‚¨ ì¶”êµ¬"},
            {q:"ìµœì• ", a:"ê°€ì¥ ì‚¬ë‘í•¨"}, {q:"TMI", a:"Too Much Information"},
            {q:"ì¼€ë°”ì¼€", a:"ì¼€ì´ìŠ¤ ë°”ì´ ì¼€ì´ìŠ¤"}, {q:"í• ë§í•˜ì•Š", a:"í•  ë§ì€ ë§ì§€ë§Œ í•˜ì§€ ì•Šê² ë‹¤"}
        ],
        [ // Set 4
            {q:"ë‚´ë¡œë‚¨ë¶ˆ", a:"ë‚´ê°€ í•˜ë©´ ë¡œë§¨ìŠ¤ ë‚¨ì´ í•˜ë©´ ë¶ˆë¥œ"}, {q:"ë‹µì •ë„ˆ", a:"ë‹µì€ ì •í•´ì ¸ ìˆê³  ë„ˆëŠ” ëŒ€ë‹µë§Œ í•´"},
            {q:"ë¼ë–¼ëŠ”ë§ì´ì•¼", a:"ë‚˜ ë•ŒëŠ” ë§ì´ì•¼ (ê¼°ëŒ€)"}, {q:"ë¬´ë¬¼", a:"ë¬´ì—‡ì´ë“  ë¬¼ì–´ë³´ì„¸ìš”"},
            {q:"ë°˜ëª¨", a:"ë°˜ë§ ëª¨ë“œ"}, {q:"ë¹¼ë°•", a:"ë¹¼ë„ ë°•ë„ ëª»í•˜ë‹¤"},
            {q:"ì„±ë•", a:"ì„±ê³µí•œ ë•í›„"}, {q:"ì¸ì‹¸", a:"ì¸ì‚¬ì´ë”"},
            {q:"ì•„ì‹¸", a:"ì•„ì›ƒì‚¬ì´ë”"}, {q:"ì›Œë¼ë°¸", a:"Work and Life Balance"}
        ],
        [ // Set 5
            {q:"ì¢‹ëŒ“êµ¬ì•Œ", a:"ì¢‹ì•„ìš” ëŒ“ê¸€ êµ¬ë… ì•Œë¦¼ì„¤ì •"}, {q:"êµ¬ì·¨", a:"êµ¬ë… ì·¨ì†Œ"},
            {q:"ìŠ¬ì„¸ê¶Œ", a:"ìŠ¬ë¦¬í¼ ì‹ ê³  ê°ˆ ìˆ˜ ìˆëŠ” ê±°ë¦¬"}, {q:"ìŠ¤ë²…", a:"ìŠ¤íƒ€ë²…ìŠ¤"},
            {q:"ë§¥ë‚ ", a:"ë§¥ë„ë‚ ë“œ"}, {q:"ë² ë¼", a:"ë°°ìŠ¤í‚¨ë¼ë¹ˆìŠ¤"},
            {q:"í˜ë¶", a:"í˜ì´ìŠ¤ë¶"}, {q:"ì¸ë³„", a:"ì¸ìŠ¤íƒ€ê·¸ë¨"},
            {q:"íŠ¸ìœ—", a:"íŠ¸ìœ„í„°"}, {q:"í†¡ë””", a:"ì¹´ì¹´ì˜¤í†¡ ì•„ì´ë””"}
        ],
        [ // Set 6
            {q:"ë‚„ë‚„ë¹ ë¹ ", a:"ë‚„ ë•Œ ë¼ê³  ë¹ ì§ˆ ë•Œ ë¹ ì ¸ë¼"}, {q:"ì‚¬ë°”ì‚¬", a:"ì‚¬ëŒ ë°”ì´ ì‚¬ëŒ"},
            {q:"ì• ë¹¼ì‹œ", a:"ì• êµ ë¹¼ë©´ ì‹œì²´"}, {q:"í˜¼ì½”ë…¸", a:"í˜¼ì ì½”ì¸ ë…¸ë˜ë°©"},
            {q:"ì˜ëŒ", a:"ì˜í˜¼ê¹Œì§€ ëŒì–´ëª¨ìŒ"}, {q:"ë¹šíˆ¬", a:"ë¹šë‚´ì„œ íˆ¬ì"},
            {q:"ë–¡ìƒ", a:"ê°€ê²©ì´ ê¸‰ê²©íˆ ì˜¤ë¦„"}, {q:"ë–¡ë½", a:"ê°€ê²©ì´ ê¸‰ê²©íˆ ë–¨ì–´ì§"},
            {q:"ì¡´ë²„", a:"Xë‚˜ê²Œ ë²„í‹°ê¸°"}, {q:"ê°“ìƒì‚´ê¸°", a:"ë¶€ì§€ëŸ°í•˜ê²Œ ì—´ì‹¬íˆ ì‚´ê¸°"}
        ],
        [ // Set 7
            {q:"ë‹¹ëª¨ì¹˜", a:"ë‹¹ì—°íˆ ëª¨ë“  ì¹˜í‚¨ì€ ì˜³ë‹¤"}, {q:"ë§›ì ", a:"ë§›ìˆëŠ” ì ì‹¬"},
            {q:"ë§›ì €", a:"ë§›ìˆëŠ” ì €ë…"}, {q:"ì¦ì ", a:"ì¦ê±°ìš´ ì ì‹¬"},
            {q:"í˜¼ë°¥", a:"í˜¼ì ë°¥ë¨¹ê¸°"}, {q:"í˜¼ìˆ ", a:"í˜¼ì ìˆ ë§ˆì‹œê¸°"},
            {q:"ë¶ˆê¸ˆ", a:"ë¶ˆíƒ€ëŠ” ê¸ˆìš”ì¼"}, {q:"ì¹¼í‡´", a:"ì¹¼ê°™ì´ í‡´ê·¼"},
            {q:"ì›”ê¸‰ë£¨íŒ¡", a:"í•˜ëŠ” ì¼ ì—†ì´ ì›”ê¸‰ë§Œ ì¶•ë‚´ëŠ” ì‚¬ëŒ"}, {q:"ìˆœì‚­", a:"ìˆœì‹ê°„ì— ì‚­ì œ"}
        ],
        [ // Set 8
            {q:"ë“í…œ", a:"ì•„ì´í…œ íšë“"}, {q:"ë ˆì–´í…œ", a:"í¬ê·€í•œ ì•„ì´í…œ"},
            {q:"í’ˆì ˆë‚¨", a:"ê²°í˜¼í•œ ë‚¨ì"}, {q:"í’ˆì ˆë…€", a:"ê²°í˜¼í•œ ì—¬ì"},
            {q:"ëŒì‹±", a:"ëŒì•„ì˜¨ ì‹±ê¸€"}, {q:"ì¸", a:"ì‚¬ê·€ê¸° ì „ ë¯¸ë¬˜í•œ ê´€ê³„"},
            {q:"ì–´ì¥ê´€ë¦¬", a:"ì—¬ëŸ¬ ì´ì„±ì„ ë™ì‹œì— ê´€ë¦¬í•¨"}, {q:"ëª¨ì†”", a:"ëª¨íƒœ ì†”ë¡œ"},
            {q:"ê¸ˆì‚¬ë¹ ", a:"ê¸ˆë°© ì‚¬ë‘ì— ë¹ ì§€ëŠ” ì‚¬ëŒ"}, {q:"ì½ì”¹", a:"ì½ê³  ì”¹ìŒ (ë‹µì¥ ì•ˆí•¨)"}
        ]
    ],
    // Game 2 Items
    game2_items: {
        3: { name: "ì™€ì¸ ì½”ë¥´í¬", desc: "3ì " },
        5: { name: "íƒêµ¬ê³µ", desc: "5ì " },
        7: { name: "í”Œë¼ìŠ¤í‹± ì™€ì¸ì”", desc: "7ì " }
    },
    // Game 3 Words
    game3_sets: {
        A: { score: 5, sets: [
            ["ë¹„í–‰ê¸°", "ê³¨í”„ì±„", "ì™€ì¸ì”", "ë„¥íƒ€ì´", "ì‹œê³„"],
            ["ì•ˆê²½", "ì¹´ë©”ë¼", "ì‚¬ê³¼", "ê°•ì•„ì§€", "í•˜íŠ¸"],
            ["ìš°ì‚°", "ì¼€ì´í¬", "íƒœì–‘", "ìë™ì°¨", "ìì „ê±°"],
            ["ì—´ì‡ ", "ì˜ì", "ëª¨ì", "ê°€ë°©", "ê¸°ë¦°"]
        ]},
        B: { score: 10, sets: [
            ["ì½”ë¼ë¦¬", "ë…¸íŠ¸ë¶", "ì „í™”ê¸°", "ê¸ˆê³ ", "í­ê·„"],
            ["ì—í íƒ‘", "ìœ ë‹ˆì½˜", "í—¬ë¦¬ì½¥í„°", "ì¶•êµ¬ê³µ", "ê±°ë¶ì´"],
            ["ì„ ì¸ì¥", "í”¼ì•„ë…¸", "ê³µë£¡", "ì ìˆ˜í•¨", "í•´ë°”ë¼ê¸°"],
            ["ìƒ´í˜ì¸", "ë¹Œë”©", "ì—¬ê¶Œ", "ë¬´ì§€ê°œ", "ìƒì–´"]
        ]},
        C: { score: 15, sets: [
            ["ìº¥ê±°ë£¨", "ìƒŒë“œìœ„ì¹˜", "ììœ ì˜ì—¬ì‹ ìƒ", "ë‹ë³´ê¸°", "ë‹¤ëŒì¥"],
            ["íŠ¸ë¡œí”¼", "ì¹´ë©œë ˆì˜¨", "í–„ë²„ê±°", "ê°€ì•¼ê¸ˆ", "ì˜¤ì§•ì–´"],
            ["ìŠ¤í•‘í¬ìŠ¤", "ìœ ëª¨ì°¨", "ì –ì†Œ", "ê³„ì‚°ê¸°", "íŒë‹¤"],
            ["ì²­ì†Œê¸°", "ê³ êµ¬ë§ˆ", "ë…ìˆ˜ë¦¬", "ë²™ì–´ë¦¬ì¥ê°‘", "ë¶•ì–´ë¹µ"]
        ]}
    }
};

/* -------------------------------------------------------------------------- */
/* APP ENGINE                                  */
/* -------------------------------------------------------------------------- */
const App = {
    state: {
        scene: 'intro',
        teams: [
            { id: 1, name: 'Team 1', score: 0 },
            { id: 2, name: 'Team 2', score: 0 },
            { id: 3, name: 'Team 3', score: 0 },
            { id: 4, name: 'Team 4', score: 0 }
        ],
        game0: { used: [] },
        game1: { usedSets: [] },
        game2: { teamChoices: {1:null, 2:null, 3:null, 4:null}, completed: [] },
        game3: { usedSets: [] },
        
        // Temp Runtime State
        currentGame: null, 
        timer: null,
        timerVal: 0,
        lastResult: null
    },

    init() {
        const saved = localStorage.getItem('nP2026State');
        if(saved) {
            try {
                this.state = JSON.parse(saved);
                this.state.timer = null; // íƒ€ì´ë¨¸ëŠ” ì´ˆê¸°í™”
                
                // í”Œë ˆì´ ì¤‘ì´ì—ˆë˜ ìƒíƒœë¼ë©´ ì•ˆì „í•˜ê²Œ ë©”ë‰´ë‚˜ ê²°ê³¼í™”ë©´ìœ¼ë¡œ ë¦¬ì…‹
                if(this.state.scene.includes('_play')) {
                    this.state.scene = 'menu';
                }
            } catch(e) {
                console.error("Load Error:", e);
                localStorage.removeItem('nP2026State');
            }
        }
        this.render();
    },

    save() {
        // íƒ€ì´ë¨¸ ì œì™¸ ì €ì¥
        const toSave = { ...this.state, timer: null };
        localStorage.setItem('nP2026State', JSON.stringify(toSave));
    },

    resetData() {
        if(confirm("ëª¨ë“  ì ìˆ˜ì™€ ì§„í–‰ ìƒí™©ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            localStorage.removeItem('nP2026State');
            location.reload();
        }
    },

    router(sceneName) {
        if(this.state.timer) clearInterval(this.state.timer);
        this.state.scene = sceneName;
        this.save();
        this.render();
    },

    // ì ìˆ˜ ì¶”ê°€ (ì €ì¥ì€ í˜¸ì¶œí•˜ëŠ” ìª½ì—ì„œ ëª…ì‹œì ìœ¼ë¡œ ìˆ˜í–‰ - ë¬´í•œë£¨í”„ ë°©ì§€)
    addScore(teamId, points) {
        const team = this.state.teams.find(t => t.id == teamId);
        if(team) team.score += points;
    },

    updateTeamName(id, name) {
        const team = this.state.teams.find(t => t.id == id);
        if(team) team.name = name;
        this.save();
    },

    render() {
        const root = document.getElementById('app-root');
        const nav = document.getElementById('nav-header');
        
        if(this.state.scene === 'intro') nav.classList.add('hidden');
        else nav.classList.remove('hidden');

        root.innerHTML = '';

        try {
            switch(this.state.scene) {
                case 'intro': this.renderIntro(root); break;
                case 'schedule': this.renderSchedule(root); break;
                case 'menu': this.renderMenu(root); break;
                
                case 'game0': this.renderGame0(root); break;
                case 'game0_q': this.renderGame0Q(root); break;
                
                case 'game1': this.renderGame1Select(root); break;
                case 'game1_play': this.renderGame1Play(root); break;
                case 'game1_result': this.renderResult(root, 'game1'); break;
                
                case 'game2': this.renderGame2Select(root); break;
                case 'game2_play': this.renderGame2Play(root); break;
                case 'game2_result': this.renderResult(root, 'game2'); break;
                
                case 'game3': this.renderGame3SelectTeam(root); break;
                case 'game3_setup': this.renderGame3Setup(root); break;
                case 'game3_play': this.renderGame3Play(root); break;
                case 'game3_result': this.renderResult(root, 'game3'); break;
                
                default: root.innerHTML = `<h1 class="text-red-500">Error: Unknown Scene</h1>`;
            }
        } catch (e) {
            console.error(e);
            root.innerHTML = `<div class="text-center text-red-500">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.<br><button onclick="App.resetData()" class="border p-2 mt-4">ë°ì´í„° ì´ˆê¸°í™”</button></div>`;
        }
    },

    // --- Renderers ---

    renderIntro(el) {
        el.innerHTML = `
            <div class="text-center fade-in flex flex-col items-center justify-center h-full">
                <h2 class="text-2xl text-purple-400 mb-2 tracking-widest">New Perspective, New Beginning</h2>
                <h1 class="text-6xl md:text-8xl font-black mb-12 text-shimmer leading-tight">nPerspective<br>2026 ì‹ ë…„íšŒ</h1>
                <button onclick="App.router('schedule')" class="btn-gold px-12 py-4 rounded-full text-xl shadow-lg animate-bounce">
                    ì…ì¥í•˜ê¸°
                </button>
            </div>
        `;
    },

    renderSchedule(el) {
        let html = `
            <div class="w-full max-w-4xl fade-in">
                <h2 class="text-4xl font-bold text-center mb-10 text-[#d4af37]">EVENT SCHEDULE</h2>
                <div class="space-y-4">
        `;
        GAME_DATA.schedule.forEach(item => {
            const isAction = item.action ? 'cursor-pointer hover:border-[#d4af37] border-purple-500' : 'border-gray-700';
            const actionAttr = item.action ? `onclick="App.router('${item.action}')"` : '';
            html += `
                <div class="card-glass p-6 rounded-xl border ${isAction} transition-all flex flex-col md:flex-row items-center" ${actionAttr}>
                    <div class="w-32 text-[#d4af37] font-bold text-lg mb-2 md:mb-0">${item.time}</div>
                    <div class="flex-1 text-center md:text-left">
                        <div class="text-2xl font-bold text-white">${item.title}</div>
                        <div class="text-gray-400">${item.desc}</div>
                    </div>
                </div>
            `;
        });
        html += `</div></div>`;
        el.innerHTML = html;
    },

    renderMenu(el) {
        let boardHtml = '';
        this.state.teams.forEach(t => {
            boardHtml += `
                <div class="bg-gray-800/80 p-4 rounded-xl text-center border border-gray-600">
                    <input type="text" value="${t.name}" onchange="App.updateTeamName(${t.id}, this.value)" 
                        class="bg-transparent text-center text-xl font-bold text-white w-full border-b border-transparent focus:border-[#d4af37] outline-none mb-2">
                    <div class="text-4xl font-black text-[#d4af37]">${t.score}</div>
                    <div class="text-xs text-gray-500">POINTS</div>
                </div>
            `;
        });

        el.innerHTML = `
            <div class="w-full max-w-6xl fade-in flex flex-col gap-10">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <button onclick="App.router('game0')" class="h-60 card-glass rounded-2xl p-6 hover:bg-white/5 transition-all group flex flex-col items-center justify-center border border-purple-500/30">
                        <div class="text-5xl mb-4 group-hover:scale-110 transition-transform">ğŸƒ</div>
                        <div class="text-2xl font-bold text-[#d4af37] mb-2">Game 0</div>
                        <div class="text-gray-300">ì„œë¡œ ì•Œì•„ê°€ìš”</div>
                    </button>
                    <button onclick="App.router('game1')" class="h-60 card-glass rounded-2xl p-6 hover:bg-white/5 transition-all group flex flex-col items-center justify-center border border-purple-500/30">
                        <div class="text-5xl mb-4 group-hover:scale-110 transition-transform">ğŸ§ </div>
                        <div class="text-2xl font-bold text-[#d4af37] mb-2">Game 1</div>
                        <div class="text-gray-300">ì‹ ì¡°ì–´ í€´ì¦ˆ</div>
                    </button>
                    <button onclick="App.router('game2')" class="h-60 card-glass rounded-2xl p-6 hover:bg-white/5 transition-all group flex flex-col items-center justify-center border border-purple-500/30">
                        <div class="text-5xl mb-4 group-hover:scale-110 transition-transform">ğŸ¤²</div>
                        <div class="text-2xl font-bold text-[#d4af37] mb-2">Game 2</div>
                        <div class="text-gray-300">ì†ë“± ë¦´ë ˆì´</div>
                    </button>
                    <button onclick="App.router('game3')" class="h-60 card-glass rounded-2xl p-6 hover:bg-white/5 transition-all group flex flex-col items-center justify-center border border-purple-500/30">
                        <div class="text-5xl mb-4 group-hover:scale-110 transition-transform">ğŸ¨</div>
                        <div class="text-2xl font-bold text-[#d4af37] mb-2">Game 3</div>
                        <div class="text-gray-300">ì¤„ì¤„ì´ ê·¸ë ¤ìš”</div>
                    </button>
                </div>
                <div>
                    <h3 class="text-center text-gray-400 mb-4 tracking-widest text-sm">LIVE SCOREBOARD</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">${boardHtml}</div>
                </div>
            </div>
        `;
    },

    // --- Game 0 ---
    renderGame0(el) {
        let grid = '';
        for(let i=1; i<=40; i++) {
            const used = this.state.game0.used.includes(i);
            grid += `<button onclick="App.runGame0(${i})" ${used?'disabled':''} class="aspect-square rounded-lg text-xl font-bold flex items-center justify-center transition-all ${used?'bg-gray-800 text-gray-600':'bg-purple-900/40 border border-purple-500 hover:bg-[#d4af37] hover:text-black hover:scale-110'}">${i}</button>`;
        }
        el.innerHTML = `
            <div class="w-full max-w-5xl fade-in flex flex-col items-center">
                <h2 class="text-3xl font-bold text-[#d4af37] mb-2">Game 0. ìš°ë¦¬, ì„œë¡œ ì•Œì•„ê°€ìš”</h2>
                <p class="text-gray-400 mb-8">ë²ˆí˜¸ë¥¼ ì„ íƒí•˜ì—¬ ì§ˆë¬¸ì— ë‹µí•´ì£¼ì„¸ìš” (30ì´ˆ)</p>
                <div class="grid grid-cols-5 md:grid-cols-8 gap-3 w-full mb-8">${grid}</div>
                <button onclick="App.router('menu')" class="text-gray-500 underline">ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°</button>
            </div>
        `;
    },
    runGame0(num) {
        this.state.currentGame = { type: 0, num: num };
        this.router('game0_q');
    },
    renderGame0Q(el) {
        const q = GAME_DATA.game0_questions[this.state.currentGame.num - 1] || "ì§ˆë¬¸ ì˜¤ë¥˜";
        el.innerHTML = `
            <div class="w-full max-w-4xl fade-in text-center flex flex-col items-center justify-center min-h-[60vh]">
                <div class="text-9xl font-black text-gray-800 absolute z-[-1] opacity-50">${this.state.currentGame.num}</div>
                <h1 class="text-4xl md:text-5xl font-bold leading-tight mb-12 break-keep">${q}</h1>
                <div class="w-full bg-gray-800 h-2 rounded-full mb-12 overflow-hidden"><div class="bg-[#d4af37] h-full w-full" style="animation: width 30s linear forwards;"></div></div>
                <style>@keyframes width { from { width: 100%; } to { width: 0%; } }</style>
                <button onclick="App.finishGame0(${this.state.currentGame.num})" class="btn-gold px-12 py-4 rounded-full text-xl">ë‹µë³€ ì¢…ë£Œ</button>
            </div>
        `;
    },
    finishGame0(num) {
        if(!this.state.game0.used.includes(num)) this.state.game0.used.push(num);
        this.router('game0');
    },

    // --- Game 1 ---
    renderGame1Select(el) {
        const opts = this.state.teams.map(t=>`<option value="${t.id}">${t.name}</option>`).join('');
        let sets = '';
        for(let i=1; i<=8; i++) {
            const used = this.state.game1.usedSets.includes(i);
            sets += `<button onclick="App.runGame1(${i})" ${used?'disabled':''} class="h-24 rounded-xl border flex flex-col items-center justify-center ${used?'bg-gray-800 border-gray-700 text-gray-600':'bg-gray-800/50 border-[#d4af37] text-[#d4af37] hover:bg-[#d4af37] hover:text-black'}"><span class="text-xl font-bold">SET ${i}</span><span class="text-xs">${used?'ì™„ë£Œ':'ì„ íƒ'}</span></button>`;
        }
        el.innerHTML = `
            <div class="w-full max-w-2xl fade-in text-center">
                <h2 class="text-3xl font-bold text-[#d4af37] mb-6">Game 1. ì‹ ì¡°ì–´ í€´ì¦ˆ</h2>
                <div class="mb-8 bg-gray-900 p-6 rounded-xl border border-gray-700"><label class="block text-left text-gray-400 text-sm mb-2">íŒ€ ì„ íƒ</label><select id="g1-team" class="w-full p-4 bg-black border border-purple-500 rounded-lg text-white text-xl">${opts}</select></div>
                <div class="grid grid-cols-4 gap-4 mb-8">${sets}</div>
                <button onclick="App.router('menu')" class="text-gray-500 underline">ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°</button>
            </div>
        `;
    },
    runGame1(setNum) {
        const teamId = document.getElementById('g1-team').value;
        this.state.currentGame = { type: 1, setNum, teamId, qIndex: 0, score: 0 };
        this.state.timerVal = 120; // ì´ˆê¸°í™”
        this.router('game1_play');
        this.startTimer(120, () => this.finishGame1(true)); 
    },
    renderGame1Play(el) {
        const game = this.state.currentGame;
        const set = GAME_DATA.game1_sets[game.setNum - 1];
        const q = set[game.qIndex];
        
        // í˜„ì¬ ë‚¨ì€ ì‹œê°„ì„ ë°”ë¡œ ì‚¬ìš©
        const t = this.state.timerVal;
        const m = Math.floor(t/60).toString().padStart(2,'0');
        const s = (t%60).toString().padStart(2,'0');
        const timeStr = `${m}:${s}`;
        
        el.innerHTML = `
            <div class="w-full max-w-4xl fade-in text-center flex flex-col items-center justify-center min-h-[70vh]">
                <div class="absolute top-0 right-0 text-[#d4af37] font-mono text-4xl font-bold" id="timer-display">${timeStr}</div>
                <div class="text-gray-500 mb-4 font-bold tracking-widest">SET ${game.setNum} - Q${game.qIndex+1}/10</div>
                <div class="bg-white text-black px-20 py-16 rounded-3xl mb-12 w-full shadow-[0_0_50px_rgba(255,255,255,0.2)]">
                    <div class="text-6xl md:text-8xl font-black mb-4">${q.q}</div>
                    <div id="ans" class="text-2xl text-purple-700 font-bold opacity-0 transition-opacity">${q.a}</div>
                </div>
                <div class="flex gap-4">
                    <button onclick="document.getElementById('ans').classList.remove('opacity-0')" class="px-8 py-4 border border-gray-500 rounded-xl hover:bg-gray-800">ì •ë‹µ í™•ì¸</button>
                    <button onclick="App.game1Action(true)" class="px-8 py-4 bg-green-600 rounded-xl font-bold text-xl hover:bg-green-500 shadow-lg">ì •ë‹µ (+5)</button>
                    <button onclick="App.game1Action(false)" class="px-8 py-4 bg-red-600 rounded-xl font-bold text-xl hover:bg-red-500 shadow-lg">íŒ¨ìŠ¤/ì˜¤ë‹µ</button>
                </div>
            </div>
        `;
    },
    game1Action(isCorrect) {
        const game = this.state.currentGame;
        if(isCorrect) game.score += 5;
        game.qIndex++;
        
        // ì‹œê°„ ì¢…ë£Œê°€ ì•„ë‹Œ, ë¬¸ì œë¥¼ ëª¨ë‘ í‘¼ ê²½ìš° finishGame1(false) í˜¸ì¶œ
        if(game.qIndex >= 10) this.finishGame1(false);
        else { this.save(); this.render(); } // í™”ë©´ ê°±ì‹  (ë¦¬ë Œë”ë§)
    },
    finishGame1(isTimeOut = false) {
        if(this.state.timer) clearInterval(this.state.timer);
        const game = this.state.currentGame;
        if(!this.state.game1.usedSets.includes(game.setNum)) {
            this.state.game1.usedSets.push(game.setNum);
            this.addScore(game.teamId, game.score);
        }
        
        // ê²°ê³¼ í™”ë©´ ë©”ì‹œì§€ ë¶„ê¸° ì²˜ë¦¬
        const title = isTimeOut ? "Time's Up!" : "Mission Clear!";
        const desc = isTimeOut ? "ì œí•œ ì‹œê°„ ì¢…ë£Œ (ë‚¨ì€ ë¬¸ì œ íŒ¨ìŠ¤)" : "ëª¨ë“  ë¬¸ì œ í’€ì´ ì™„ë£Œ!";
        
        this.state.lastResult = { 
            title: title, 
            team: this.state.teams.find(t=>t.id==game.teamId).name, 
            score: game.score, 
            desc: desc,
            next: 'game1' 
        };
        this.router('game1_result');
    },

    // --- Game 2 ---
    renderGame2Select(el) {
        const teams = this.state.teams;
        const allSelected = teams.every(t => this.state.game2.teamChoices[t.id]);
        let grid = '';
        
        teams.forEach(t => {
            const choice = this.state.game2.teamChoices[t.id];
            const done = this.state.game2.completed.includes(t.id);
            let content = '';
            
            if(!choice) {
                content = `
                    <div class="text-gray-400 mb-4">ë‚œì´ë„ ì„ íƒ</div>
                    <div class="flex gap-2 justify-center">
                        <button onclick="App.setGame2Choice(${t.id}, 3)" class="px-3 py-1 border border-green-500 rounded hover:bg-green-900">3</button>
                        <button onclick="App.setGame2Choice(${t.id}, 5)" class="px-3 py-1 border border-blue-500 rounded hover:bg-blue-900">5</button>
                        <button onclick="App.setGame2Choice(${t.id}, 7)" class="px-3 py-1 border border-red-500 rounded hover:bg-red-900">7</button>
                    </div>`;
            } else if (!allSelected) {
                content = `<div class="text-2xl font-bold text-gray-500">ì„ íƒ ì™„ë£Œ</div>`;
            } else {
                const item = GAME_DATA.game2_items[choice];
                content = `
                    <div class="text-[#d4af37] text-2xl font-bold mb-1">${choice}ì </div>
                    <div class="text-white text-lg font-bold mb-4">${item.name}</div>
                    ${done ? `<div class="text-gray-500">í”Œë ˆì´ ì™„ë£Œ</div>` : `<button onclick="App.runGame2(${t.id})" class="w-full btn-gold py-2 rounded">START</button>`}`;
            }
            grid += `<div class="bg-gray-900 p-6 rounded-xl border ${choice?'border-[#d4af37]':'border-gray-700'} text-center"><h3 class="text-xl font-bold mb-4 text-purple-400">${t.name}</h3>${content}</div>`;
        });

        el.innerHTML = `
            <div class="w-full max-w-6xl fade-in">
                <h2 class="text-3xl font-bold text-center text-[#d4af37] mb-8">Game 2. ì†ë“± ë¦´ë ˆì´</h2>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">${grid}</div>
                <div class="text-center"><button onclick="App.router('menu')" class="text-gray-500 underline">ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°</button></div>
            </div>
        `;
    },
    setGame2Choice(id, val) {
        this.state.game2.teamChoices[id] = val;
        this.save(); this.render();
    },
    runGame2(id) {
        const score = this.state.game2.teamChoices[id];
        this.state.currentGame = { type: 2, teamId: id, scorePerItem: score, count: 0 };
        this.state.timerVal = 180;
        this.router('game2_play');
        this.startTimer(180, () => this.finishGame2()); // 3ë¶„
    },
    renderGame2Play(el) {
        const game = this.state.currentGame;
        const item = GAME_DATA.game2_items[game.scorePerItem];
        const team = this.state.teams.find(t=>t.id==game.teamId).name;
        
        // í˜„ì¬ ë‚¨ì€ ì‹œê°„ì„ ë°”ë¡œ ì‚¬ìš©
        const t = this.state.timerVal;
        const m = Math.floor(t/60).toString().padStart(2,'0');
        const s = (t%60).toString().padStart(2,'0');
        const timeStr = `${m}:${s}`;

        el.innerHTML = `
            <div class="w-full max-w-3xl fade-in text-center flex flex-col items-center justify-center min-h-[70vh]">
                <h2 class="text-3xl text-purple-400 font-bold mb-4">${team}</h2>
                <div class="text-5xl font-bold text-white mb-8">ì•„ì´í…œ: <span class="text-[#d4af37]">${item.name}</span></div>
                <div class="text-9xl font-mono font-bold text-white mb-12" id="timer-display">${timeStr}</div>
                <div class="bg-gray-800 p-8 rounded-2xl border border-gray-700 w-full max-w-lg">
                    <div class="text-gray-400 mb-2">ì„±ê³µ íšŸìˆ˜</div>
                    <div class="text-7xl font-black text-white mb-8" id="count">${game.count}</div>
                    <div class="flex gap-4 justify-center">
                        <button onclick="App.game2Count(-1)" class="w-20 h-20 rounded-full bg-gray-700 text-3xl">-</button>
                        <button onclick="App.game2Count(1)" class="w-20 h-20 rounded-full bg-green-600 text-3xl shadow-lg">+</button>
                    </div>
                </div>
                <button onclick="App.finishGame2()" class="mt-8 text-red-500 border border-red-900 px-4 py-2 rounded">ì¡°ê¸° ì¢…ë£Œ</button>
            </div>
        `;
    },
    game2Count(d) {
        const g = this.state.currentGame;
        if(g.count+d >=0) { g.count+=d; document.getElementById('count').innerText = g.count; }
    },
    finishGame2() {
        if(this.state.timer) clearInterval(this.state.timer);
        const game = this.state.currentGame;
        const total = game.count * game.scorePerItem;
        if(!this.state.game2.completed.includes(game.teamId)) {
            this.state.game2.completed.push(game.teamId);
            this.addScore(game.teamId, total);
        }
        this.state.lastResult = { title: "Time's Up!", team: this.state.teams.find(t=>t.id==game.teamId).name, score: total, desc: `(${game.count}ê°œ x ${game.scorePerItem}ì )`, next: 'game2' };
        this.router('game2_result');
    },

    // --- Game 3 ---
    renderGame3SelectTeam(el) {
        const html = this.state.teams.map(t => `<button onclick="App.runGame3Setup(${t.id})" class="p-8 bg-gray-800 border border-gray-600 rounded-xl hover:border-[#d4af37] hover:bg-gray-700 transition-all"><div class="text-3xl font-bold text-white mb-2">${t.name}</div><div class="text-[#d4af37]">í˜„ì¬ ${t.score}ì </div></button>`).join('');
        el.innerHTML = `
            <div class="w-full max-w-5xl fade-in text-center">
                <h2 class="text-3xl font-bold text-[#d4af37] mb-10">Game 3. ì¤„ì¤„ì´ ê·¸ë ¤ìš”</h2>
                <div class="grid grid-cols-2 gap-6 mb-12">${html}</div>
                <button onclick="App.router('menu')" class="text-gray-500 underline">ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°</button>
            </div>
        `;
    },
    runGame3Setup(id) {
        this.state.currentGame = { type: 3, teamId: id, level: null, setIdx: null, qIndex: 0, setScore: 0, correctCnt: 0 };
        this.router('game3_setup');
    },
    renderGame3Setup(el) {
        const team = this.state.teams.find(t=>t.id==this.state.currentGame.teamId).name;
        let html = '';
        ['A','B','C'].forEach(lvl => {
            const info = GAME_DATA.game3_sets[lvl];
            let btns = '';
            info.sets.forEach((_,i) => {
                const used = this.state.game3.usedSets.includes(`${lvl}-${i}`);
                btns += `<button onclick="App.runGame3Start('${lvl}', ${i})" ${used?'disabled':''} class="w-12 h-12 rounded bg-gray-700 border border-gray-600 hover:bg-[#d4af37] hover:text-black disabled:opacity-30">${i+1}</button>`;
            });
            html += `<div class="bg-gray-900 p-6 rounded-xl border border-gray-700"><div class="flex justify-between items-center mb-4"><span class="text-2xl font-bold text-purple-400">Level ${lvl}</span><span class="text-sm bg-gray-800 px-2 py-1 rounded border border-gray-600">${info.score}ì /ê°œ</span></div><div class="flex gap-3 justify-center">${btns}</div></div>`;
        });
        el.innerHTML = `
            <div class="w-full max-w-4xl fade-in text-center">
                <h2 class="text-3xl font-bold text-white mb-2">${team}</h2>
                <p class="text-gray-400 mb-8">ë‚œì´ë„ì™€ ì„¸íŠ¸ ì„ íƒ</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">${html}</div>
                <button onclick="App.router('game3')" class="text-gray-500 underline">íŒ€ ë‹¤ì‹œ ì„ íƒ</button>
            </div>
        `;
    },
    runGame3Start(lvl, idx) {
        const game = this.state.currentGame;
        game.level = lvl; game.setIdx = idx;
        this.router('game3_play');
        this.startLoopTimer();
    },
    startLoopTimer() {
        if(this.state.timer) clearInterval(this.state.timer);
        let t = 10;
        const update = () => {
            const bar = document.getElementById('loop-bar');
            const txt = document.getElementById('loop-text');
            if(bar && txt) {
                bar.style.width = `${(t/10)*100}%`;
                bar.style.backgroundColor = t<=3 ? '#ef4444' : '#d4af37';
                txt.innerText = Math.ceil(t);
            }
        };
        this.state.timer = setInterval(() => {
            t -= 0.1;
            if(t <= 0) t = 10;
            update();
        }, 100);
    },
    renderGame3Play(el) {
        const game = this.state.currentGame;
        const word = GAME_DATA.game3_sets[game.level].sets[game.setIdx][game.qIndex];
        
        el.innerHTML = `
            <div class="w-full max-w-4xl fade-in flex flex-col items-center justify-center min-h-[70vh] relative text-center">
                <div class="absolute top-0 right-0 text-gray-500 font-bold">Q${game.qIndex+1}/5</div>
                <div class="text-8xl font-black text-white mb-12 tracking-wider drop-shadow-[0_0_15px_rgba(255,255,255,0.5)]">${word}</div>
                <div class="w-full max-w-2xl mb-12 relative">
                    <div class="flex justify-between text-gray-400 mb-1"><span>Loop Timer</span><span id="loop-text" class="font-bold text-[#d4af37]">10</span></div>
                    <div class="w-full bg-gray-800 h-4 rounded-full overflow-hidden border border-gray-600"><div id="loop-bar" class="h-full w-full bg-[#d4af37] transition-all duration-100 ease-linear"></div></div>
                </div>
                <div class="flex gap-6">
                    <button onclick="App.game3Action(true)" class="px-10 py-5 bg-green-600 rounded-2xl font-bold text-2xl hover:bg-green-500 shadow-lg transform hover:-translate-y-1 transition-all">ì •ë‹µ!</button>
                    <button onclick="App.game3Action(false)" class="px-10 py-5 bg-gray-700 rounded-2xl font-bold text-2xl hover:bg-gray-600 shadow-lg transform hover:-translate-y-1 transition-all">íŒ¨ìŠ¤</button>
                </div>
            </div>
        `;
    },
    game3Action(isCorrect) {
        const game = this.state.currentGame;
        const info = GAME_DATA.game3_sets[game.level];
        const totalQ = info.sets[game.setIdx].length;

        if(isCorrect) {
            game.correctCnt++;
            game.setScore += info.score;
        }
        game.qIndex++;

        // Reset timer loop visually (logic handled by interval)
        if(this.state.timer) { clearInterval(this.state.timer); this.startLoopTimer(); }

        if(game.qIndex >= totalQ) {
            this.finishGame3();
        } else {
            this.save();
            this.render(); // Re-render next word
        }
    },
    finishGame3() {
        if(this.state.timer) clearInterval(this.state.timer);
        const game = this.state.currentGame;
        const setId = `${game.level}-${game.setIdx}`;
        
        if(!this.state.game3.usedSets.includes(setId)) {
            this.state.game3.usedSets.push(setId);
            this.addScore(game.teamId, game.setScore);
        }
        
        this.state.lastResult = { title: "Round Finished!", team: this.state.teams.find(t=>t.id==game.teamId).name, score: game.setScore, desc: `${game.correctCnt}ë¬¸ì œ ì •ë‹µ`, next: 'game3' };
        this.router('game3_result');
    },

    // --- Result Screen ---
    renderResult(el, nextScene) {
        const res = this.state.lastResult;
        el.innerHTML = `
            <div class="text-center fade-in">
                <h2 class="text-4xl font-bold text-[#d4af37] mb-8">${res.title}</h2>
                <div class="text-2xl mb-2 text-gray-300">${res.team} íšë“ ì ìˆ˜</div>
                <div class="text-8xl font-black text-white mb-4">${res.score} ì </div>
                ${res.desc ? `<div class="text-gray-500 mb-12">${res.desc}</div>` : `<div class="mb-12"></div>`}
                <button onclick="App.router('${nextScene}')" class="btn-gold px-12 py-4 rounded-full text-xl">ë‹¤ìŒìœ¼ë¡œ ì´ë™</button>
            </div>
        `;
    },

    // --- Timer Utility ---
    startTimer(seconds, onFinish) {
        if(this.state.timer) clearInterval(this.state.timer);
        this.state.timerVal = seconds;
        
        const update = () => {
            const el = document.getElementById('timer-display');
            if(el) {
                const m = Math.floor(this.state.timerVal/60).toString().padStart(2,'0');
                const s = (this.state.timerVal%60).toString().padStart(2,'0');
                el.innerText = `${m}:${s}`;
                if(this.state.timerVal <= 10) el.classList.add('urgent-pulse');
            }
        };
        
        // update(); // Initial render handles this
        this.state.timer = setInterval(() => {
            this.state.timerVal--;
            update();
            if(this.state.timerVal <= 0) {
                clearInterval(this.state.timer);
                if(onFinish) onFinish();
            }
        }, 1000);
    }
};

window.onload = () => App.init();
</script>
</body>
</html>
